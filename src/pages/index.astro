---
import DefaultLayout from '@layouts/DefaultLayout.astro'

import BlogPostPreview from '@components/BlogPostPreview.vue';
import { getPostsPreview, getPageBySlug } from '@lib/api';

const indexDe: any = await getPageBySlug('blog-index-de');
// const indexEn: any = await getPageBySlug('blog-index-en');

const posts: any = await getPostsPreview();

// const allPost = posts.nodes.map(post => {
//   let posts = {...post};

//   // console.log('vorher', posts);

//   if (post.translations.length) {
//     console.log('MIT POST', post.slug, post.translations[0].slug);


//     posts = {...post.translations[0], ...post};
//   }
//   // delete post.translations;
//   // posts = {...post};

//   console.log('nacher', posts.slug);


//   return posts;
// });

---
<DefaultLayout content={indexDe}>
  <section class="intro">
    <h1>{indexDe.title}</h1>
  </section>
  <section aria-label="Blog post list">
    <BlogPostPreview posts={posts} client:visible></BlogPostPreview>
  </section>
</DefaultLayout>
